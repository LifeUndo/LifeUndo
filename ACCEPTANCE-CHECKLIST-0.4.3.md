# ‚úÖ ACCEPTANCE CHECKLIST 0.4.3 - –î–æ–±–∏–≤–∞–µ–º –ø—Ä–∏—ë–º–∫—É

## **1) –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–∏—ë–º–æ—á–Ω—ã–π –ø—Ä–æ–≥–æ–Ω (5 –º–∏–Ω—É—Ç)**

### **0) ENV –Ω–∞ –ø—Ä–æ–¥–µ (–æ–±–∞ –¥–æ–º–µ–Ω–∞/Beget):**
```bash
export INTERNAL_USAGE_KEY='<—Ç–æ—Ç_–∂–µ_—á—Ç–æ_–≤ .env>'
export NEXT_PUBLIC_APP_VERSION=0.4.3
```

### **1) –°–±–æ—Ä–∫–∞/—Ä–µ—Å—Ç–∞—Ä—Ç (–µ—Å–ª–∏ –Ω–æ–¥–∞ –≤—Ä—É—á–Ω—É—é):**
```bash
npm run build && npm start
```

### **2) E2E —Å–º–æ—É–∫:**
```bash
npm run test:e2e
```

### **3) –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ-–ª–æ–≥–≥–µ—Ä–∞ (middleware ‚Üí /api/_usage):**
```bash
# —Å–¥–µ–ª–∞–µ–º –ø–∞—Ä—É –ø—É–±–ª–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è):
curl -s https://getlifeundo.com/api/public/pricing >/dev/null
curl -s https://getlifeundo.com/status >/dev/null
```

### **4) –°–≤–æ–¥–∫–∞ usage:**
```bash
curl -s -u admin:****** https://getlifeundo.com/api/admin/usage/summary | jq
```

### **5) –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ (7 –¥–Ω–µ–π):**
```bash
curl -s -u admin:****** "https://getlifeundo.com/api/admin/usage/timeseries?days=7" | jq
```

**–û–∂–∏–¥–∞–µ–º –≤ `/api/admin/usage/summary`:**
- `ok: true`, `total ‚â• 2`
- –≤ `byEndpoint` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç `"/api/public/pricing"` (–∏/–∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–µ—Ä–≥–∞–µ–º—ã–µ —Ä–æ—É—Ç—ã)

## **2) –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ UI –∞–¥–º–∏–Ω–∫–∏**

- –û—Ç–∫—Ä–æ–π `/admin` ‚Üí –≤–∏–¥–Ω–∞ —Å—Å—ã–ª–∫–∞ **Usage –¥–∞—à–±–æ—Ä–¥** ‚Üí –≥—Ä–∞—Ñ–∏–∫/—Ç–∞–±–ª–∏—Ü–∞
- `/admin/status` ‚Üí –≤–∫–ª—é—á–∏ –±–∞–Ω–Ω–µ—Ä ‚Üí –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ `/status`
- `/admin/emails` ‚Üí upsert —à–∞–±–ª–æ–Ω –∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç¬ª ‚Üí –ø–∏—Å—å–º–æ –ø—Ä–∏—à–ª–æ

## **3) –§–∏–Ω–∞–ª—å–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏ –ø–æ—Å–ª–µ ¬´–∑–µ–ª—ë–Ω–æ–≥–æ¬ª**

- Cloudflare: Dev Mode **OFF**, 301 `www‚Üíapex`, Cache Rules: **Bypass** `/api/*`, `/admin*`
- Sentry: –ø–æ–º–µ—Ç–∏—Ç—å —Ä–µ–ª–∏–∑ **0.4.3**
- SEO: `GET /robots.txt` –∏ `/sitemap.xml` ‚Üí 200
- `/status` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: **App version: 0.4.3**

## **4) –ï—Å–ª–∏ usage –Ω–µ —Ä–∞—Å—Ç—ë—Ç (—Ç–æ—á–µ—á–Ω—ã–µ —Ñ–∏–∫—Å—ã)**

### **INTERNAL_USAGE_KEY:**
- –û–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `.env` **–∏** –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –Ω–∞ –ø—Ä–æ–¥–µ

### **–ò—Å–∫–ª—é—á–µ–Ω–∏—è –≤ middleware:**
- –õ–æ–≥–µ—Ä –Ω–µ –ø–∏—à–µ—Ç –¥–ª—è `/api/_usage` –∏ `/api/admin/*` ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### **DB-—Ç–∞–±–ª–∏—Ü—ã –Ω–µ—Ç:**
- –ü—Ä–æ–≥–Ω–∞—Ç—å `migrations/030_usage_events_optional.sql`

### **CORS/Origin:**
- Middleware —à–ª—ë—Ç –Ω–∞ `${origin}/api/_usage` ‚Äî –Ω–∞ –ø—Ä–æ–¥–µ –æ–∫
- –ï—Å–ª–∏ –µ—Å—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ ‚Äî –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–π—Ç–µ –ø—É—Ç—å `/api/_usage`

## **5) –ú–∏–Ω–∏-rollback (–µ—Å–ª–∏ –≤–¥—Ä—É–≥)**

- –í `middleware.ts` –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫ `fetch(.../api/_usage)` –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∞–≤—Ç–æ-–ª–æ–≥–æ–≤
- –≠–Ω–¥–ø–æ–π–Ω—Ç `/api/_usage` –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å ‚Äî –æ–Ω –±–µ–∑ –∫–ª—é—á–∞ –Ω–µ –ø—Ä–∏–º–µ—Ç –∑–∞–ø—Ä–æ—Å

## **üéØ –ì–û–¢–û–í–û:**

**–•–æ—á–µ—à—å ‚Äî —Å—Ä–∞–∑—É –ø—Ä–∏–∫—Ä—É—á—É /developers —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ SDK –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ npm/PyPI –∏ –¥–æ–±–∞–≤–ª—é –º–∏–Ω–∏-—á–∞—Ä—Ç –≤ usage (recharts). –°–∫–∞–∂–∏: ¬´SDK + —á–∞—Ä—Ç ‚Äî –æ–¥–Ω–∏–º –ø–æ—Å—Ç–æ–º¬ª, –∏ –≤—ã–¥–∞–º –ø–∞—Ç—á! üöÄ**

