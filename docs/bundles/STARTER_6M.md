# Starter Bundle (6 месяцев)

## Описание

**Starter Bundle** - это специальный пакет, который включает:
- **Pro подписку на 6 месяцев** (180 дней)
- **Бонусный флаг `starter_bonus`** на тот же период
- **Цена:** 3000 ₽ (выгода 594 ₽ по сравнению с помесячной оплатой)

## Логика активации

### При покупке

1. Пользователь оплачивает через FreeKassa
2. Webhook получает уведомление с `order_id` формата `S6M-{timestamp}-{random}`
3. Извлекается план `starter_6m` из префикса
4. Активируется:
   - Pro лицензия с `expires_at = now + 180 дней`
   - Feature flag `starter_bonus = true` с `expires_at = now + 180 дней`

### Продление существующей лицензии

Если у пользователя уже есть активная Pro подписка:
- Новая дата окончания = `max(now, current_expires_at) + 180 дней`
- Бонусный флаг продлевается аналогично

## Идемпотентность

Webhook проверяет `order_id` перед обработкой:
- Если платеж уже обработан (`status = 'paid'`) - возвращает `YES` без повторной активации
- Повторные вызовы не дублируют лицензии

## База данных

### Таблица `payments`
```sql
{
  order_id: "S6M-1759309857846-fi91lj",
  plan: "starter_6m",
  amount: 3000.00,
  currency: "RUB",
  status: "paid",
  paid_at: "2025-01-30T12:00:00Z"
}
```

### Таблица `licenses`
```sql
{
  email: "user@example.com",
  level: "pro",
  plan: "starter_6m",
  expires_at: "2025-07-30T12:00:00Z",
  activated_at: "2025-01-30T12:00:00Z"
}
```

### Таблица `feature_flags`
```sql
{
  email: "user@example.com",
  key: "starter_bonus",
  value: true,
  expires_at: "2025-07-30T12:00:00Z"
}
```

## FAQ

**Q: Что дает бонусный флаг?**  
A: Ранний доступ к экспериментальным функциям, специальные предложения

**Q: Можно ли продлить Starter Bundle?**  
A: Да, можно купить повторно - срок продлится на +180 дней

**Q: Что происходит после окончания срока?**  
A: Pro доступ и бонусный флаг деактивируются, возвращается Free tier

**Q: Можно ли апгрейдить до VIP?**  
A: Да, свяжитесь с поддержкой для перерасчета

