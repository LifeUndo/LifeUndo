# üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π GO/NO-GO —á–µ–∫-–ª–∏—Å—Ç (60 —Å–µ–∫—É–Ω–¥)

## ‚úÖ GO –∫—Ä–∏—Ç–µ—Ä–∏–∏

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
- [ ] **ENV –Ω–∞ –ø—Ä–æ–¥–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã** (–ø–æ—Å–ª–µ —Ä–æ—Ç–∞—Ü–∏–∏) ‚Üí `Redeploy` —Å–¥–µ–ª–∞–Ω
- [ ] **Notify (POST)** –Ω–∞ Vercel-–¥–æ–º–µ–Ω ‚Üí ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å¬ª = **200**
- [ ] **Smoke + —ç–º—É–ª—è—Ç–æ—Ä notify**: –ø–æ–∑–∏—Ç–∏–≤/–Ω–µ–≥–∞—Ç–∏–≤/–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º–æ–µ
- [ ] **iPhone –ø–ª–∞—Ç—ë–∂**: —Ä–µ–¥–∏—Ä–µ–∫—Ç —á–µ—Ä–µ–∑ `location.href` (–Ω–µ `window.open`)
- [ ] **–õ–æ–≥–∏**: —Ñ–∏–ª—å—Ç—Ä –ø–æ `FK`, —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–µ—Ç, –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è e-mail, —Å—É–º–º—ã —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å `priceMap`
- [ ] **KV**: –∑–∞–ø–∏—Å—å `order:<id>` –ø–æ—è–≤–ª—è–µ—Ç—Å—è, TTL 30 –¥–Ω–µ–π

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞
- [ ] **Rate limiting**: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –ø–æ IP
- [ ] **Honeypot**: –∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] **Correlation ID**: —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] **Timing-safe**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π –≤–∫–ª—é—á–µ–Ω–æ
- [ ] **–ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Å–µ–∫—Ä–µ—Ç—ã –∏ email –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] **–ê–ª–µ—Ä—Ç—ã**: –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ —É—Å–ø–µ—à–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –∏ –æ—à–∏–±–∫–∏
- [ ] **–õ–æ–≥–∏**: —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É `FK` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: –ø–æ–∏—Å–∫ –∏ –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª—é—á–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

## ‚ùå NO-GO –∫—Ä–∏—Ç–µ—Ä–∏–∏

### üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- [ ] **405/404 –Ω–∞ notify** ‚Üí Notify URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥
- [ ] **Bad signature** ‚Üí —Å—Ö–µ–º–∞ –ø–æ–¥–ø–∏—Å–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–∞–±–∏–Ω–µ—Ç–æ–º FK
- [ ] **Bad amount** ‚Üí —Å—É–º–º–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç priceMap
- [ ] **Rate limit exceeded** ‚Üí —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP
- [ ] **Honeypot triggered** ‚Üí –±–æ—Ç—ã –ø—ã—Ç–∞—é—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏

### ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏–µ –∑–Ω–∞–∫–∏
- [ ] **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–¥–∞—á–∏** ‚Üí –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] **–°–µ–∫—Ä–µ—Ç—ã –≤ –ª–æ–≥–∞—Ö** ‚Üí –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] **–ú–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç** ‚Üí –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ > 500ms
- [ ] **CORS –æ—à–∏–±–∫–∏** ‚Üí –ø—Ä–µ—Ñ–ª–∞–π—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üß™ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (30 —Å–µ–∫—É–Ω–¥)

### 1. Smoke Test
```bash
.\smoke-test-freekassa.ps1 https://<project>.vercel.app
```
**–û–∂–∏–¥–∞–µ–º–æ:** `create 200`, CORS –æ–∫

### 2. –≠–º—É–ª—è—Ç–æ—Ä Notify
```bash
.\fk-notify-sim.ps1 https://<project>.vercel.app MERCHANT_ID 2490.00 LU-test-123 SECRET2
```
**–û–∂–∏–¥–∞–µ–º–æ:** `OK` + –ª–æ–≥ `[FK][notify] OK`

### 3. –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
./negative-tests.sh https://<project>.vercel.app MERCHANT_ID SECRET2
```
**–û–∂–∏–¥–∞–µ–º–æ:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

### 4. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
```bash
.\test-admin.ps1 https://<project>.vercel.app ADMIN_TOKEN
```
**–û–∂–∏–¥–∞–µ–º–æ:** –ü–æ–∏—Å–∫ –∏ –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç

## üì± –¢–µ—Å—Ç –Ω–∞ iPhone

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- [ ] –û—Ç–∫—Ä—ã—Ç—å `/pricing` –Ω–∞ iPhone
- [ ] –í–≤–µ—Å—Ç–∏ email ‚Üí "–ö—É–ø–∏—Ç—å VIP"
- [ ] **–†–µ–¥–∏—Ä–µ–∫—Ç —á–µ—Ä–µ–∑ `location.href`** (–ù–ï `window.open`)
- [ ] –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ FreeKassa

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤—É—é –æ–ø–ª–∞—Ç—É
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/success.html`
- [ ] –í –ª–æ–≥–∞—Ö: `[FK][notify] OK` —Å `correlation_id`

## üìä –ü–æ—Å–ª–µ –ø–µ—Ä–≤—ã—Ö 1-2 –æ–ø–ª–∞—Ç

### –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç—á—ë—Ç–∞:
- [ ] **–°–∫—Ä–∏–Ω ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å=200¬ª** (–≤ –∫–∞–±–∏–Ω–µ—Ç–µ FK)
- [ ] **–ö—É—Å–æ–∫ –ª–æ–≥–æ–≤** —Å `[FK][notify] OK` (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤)
- [ ] **KV-–∑–∞–ø–∏—Å—å** —Å `paid:true` –∏ TTL
- [ ] **–û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∫–∏** –ø–æ `order_id` (—Å –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º email)

### –§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è:
- [ ] **–ï—â—ë –æ–¥–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤** (–æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å–ª–µ–¥–æ–≤)
- [ ] **Redeploy Production**
- [ ] **–û–±–Ω–æ–≤–∏—Ç—å ENV —Å–Ω–∞–ø—à–æ—Ç**

## üéØ –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### ‚úÖ GO (–≤—Å–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–π–¥–µ–Ω—ã)
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- iPhone —Ç–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω
- –õ–æ–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### ‚ùå NO-GO (–µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö
- –ü—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- iPhone —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω

## üìã –ß—Ç–æ –ø—Ä–∏—Å–ª–∞—Ç—å –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å–≤–µ—Ä–∫–∏

### –¢–µ–∫—Å—Ç –∏–∑ –ª–æ–≥–æ–≤ (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤):
```
[FK][create] { order_id: "LU-...", email: "ab***@domain.com", plan: "vip_lifetime", amount: 2490, correlation_id: "cid-..." }
[FK][notify] OK { order_id: "LU-...", amount: 2490, intid: "999999", correlation_id: "cid-..." }
```

### –û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∫–∏ (—Å –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º email):
```json
{
  "found": true,
  "order": {
    "order_id": "LU-...",
    "email": "ab***@domain.com",
    "plan": "vip_lifetime",
    "amount": 2490,
    "status": "paid"
  }
}
```

### –°–∫—Ä–∏–Ω –∏–∑ FK (–º–æ–∂–Ω–æ –∑–∞–º–∞–∑–∞—Ç—å –ª–∏—à–Ω–µ–µ):
- –°—É–º–º–∞/–≤–∞–ª—é—Ç–∞/–Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
- –°—Ç–∞—Ç—É—Å "–û–ø–ª–∞—á–µ–Ω–æ"
- –í—Ä–µ–º—è –æ–ø–ª–∞—Ç—ã

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**‚úÖ –í–°–ï –°–ò–°–¢–ï–ú–´ –ì–û–¢–û–í–´:**
- –ë–æ–µ–≤–∞—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∞
- –ê–Ω—Ç–∏-—Å–ø–∞–º –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- Correlation ID –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
- –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –í—ã–ø–æ–ª–Ω–∏—Ç—å GO/NO-GO —á–µ–∫-–ª–∏—Å—Ç –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏!
