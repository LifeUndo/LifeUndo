# üéØ FreeKassa Integration - –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö-–õ–ò–°–¢

## ‚úÖ **–ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ**

- **–í–µ—Ç–∫–∞**: `feature/fk-from-prod-lock` –æ—Ç –∫–æ–º–º–∏—Ç–∞ `4f7e919` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π GetLifeUndo –±—Ä–µ–Ω–¥–∏–Ω–≥)
- **API**: `/api/payments/freekassa/create` –∏ `/result` —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é
- **UI**: `FreeKassaButton` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å ENV —Ñ–ª–∞–≥–æ–º
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –∫–Ω–æ–ø–∫–∏ –Ω–∞ Pro/VIP/Team –ø–ª–∞–Ω–∞—Ö –≤ pricing page
- **ENV**: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Ç–æ–ª—å–∫–æ `FREEKASSA_*`)
- **Debug**: `/api/debug/fk` —Ç–æ–ª—å–∫–æ –¥–ª—è Preview

---

## üß™ **–ë–´–°–¢–†–´–ô –ß–ï–ö-–õ–ò–°–¢ –ü–†–ò–Å–ú–ö–ò (5 —à–∞–≥–æ–≤)**

### **1. –û—Ç–∫—Ä–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Preview (git-alias)**
–í –∫–∞—Ä—Ç–æ—á–∫–µ –¥–µ–ø–ª–æ—è –≤–µ—Ç–∫–∏ `feature/fk-from-prod-lock` –∏—Å–ø–æ–ª—å–∑—É–π URL:
- ‚úÖ `https://getlifeundo-git-feature-fk-from-prod-lock-‚Ä¶vercel.app`
- ‚ùå –ù–ï —Å–ª—É—á–∞–π–Ω—ã–π `‚Ä¶-nhvo5g2ea‚Ä¶`

### **2. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é FK**
```bash
curl https://<git-alias>/api/debug/fk
```
**–û–∂–∏–¥–∞–µ–º–æ**:
```json
{"ok":true,"fkEnabled":true,"merchantIdMasked":"54c3***"}
```

### **3. –°–æ–∑–¥–∞–π –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ API (–¥—ã–º–æ–≤—ã–π —Ç–µ—Å—Ç)**
```bash
curl -X POST https://<git-alias>/api/payments/freekassa/create \
  -H "Content-Type: application/json" \
  -d '{"productId":"getlifeundo_pro"}'
```
**–û–∂–∏–¥–∞–µ–º–æ**: JSON —Å `pay_url` –Ω–∞ `https://pay.freekassa.net/?m=...&oa=599.00&o=...&s=...&currency=RUB`

**–ü–µ—Ä–µ–π–¥–∏ –ø–æ `pay_url`** ‚Üí —Ñ–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è **–ë–ï–ó** ¬´–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Å—ã–ª–∫–∏¬ª

### **4. –ü—Ä–æ–≤–µ—Ä—å UI**
- **`/<locale>/pricing`** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/ru/pricing`) ‚Üí –≤–∏–¥–Ω—ã –∫–Ω–æ–ø–∫–∏ ¬´–û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ FreeKassa¬ª
- **`/ru/success`** –∏ **`/ru/fail`** ‚Üí —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã
- **–•–µ–¥–µ—Ä/—Ñ—É—Ç–µ—Ä** ‚Üí —Å **GetLifeUndo**, —Å–æ—Ü-–∏–∫–æ–Ω–∫–∏ –Ω–µ ¬´—Å–ª–∏–ø–∞—é—Ç—Å—è¬ª

### **5. ENV-–≥–∏–≥–∏–µ–Ω–∞ –≤ Vercel**
–í **Preview** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ–ª—å–∫–æ:
- ‚úÖ `NEXT_PUBLIC_FK_ENABLED=true`
- ‚úÖ `FREEKASSA_MERCHANT_ID`
- ‚úÖ `FREEKASSA_SECRET1`
- ‚úÖ `FREEKASSA_SECRET2`
- ‚úÖ `FREEKASSA_PAYMENT_URL=https://pay.freekassa.net/`

**–õ—é–±—ã–µ `FK_*` (–±–µ–∑ `FREEKASSA_`)** ‚Üí **–≤—ã–∫–ª—é—á–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å**

**–ü–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫ ENV** ‚Üí **Redeploy** –∏–º–µ–Ω–Ω–æ git-alias –ø—Ä–µ–≤—å—é

---

## üöÄ **–î–ê–õ–¨–®–ï (–ø–æ—Å–ª–µ –∑–µ–ª—ë–Ω–æ–π –ø—Ä–∏—ë–º–∫–∏)**

1. **Promote Preview ‚Üí Production**, –∑–∞—Ç–µ–º **Protect**
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ –∂–µ `FREEKASSA_*` + `NEXT_PUBLIC_FK_ENABLED=true` –≤ **Production**
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥–∏ 2‚Äì4 —É–∂–µ –Ω–∞ –ø—Ä–æ–¥–µ (–±—ã—Å—Ç—Ä—ã–π –¥—ã–º)

---

## üîç **–ï—Å–ª–∏ —Å–Ω–æ–≤–∞ ¬´–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Å—ã–ª–∫–∏¬ª**

–ü—Ä–∏—à–ª–∏:
- **–ü–æ–ª–Ω—ã–π `pay_url`** –∏–∑ –æ—Ç–≤–µ—Ç–∞ `/create`
- **JSON** –∏–∑ `/api/debug/fk`

–ü–æ –Ω–∏–º —Å—Ä–∞–∑—É –≤–∏–¥–Ω–æ, —á—Ç–æ –Ω–µ —Ç–∞–∫ (—Ñ–æ—Ä–º–∞—Ç —Å—É–º–º—ã, –ø–æ–¥–ø–∏—Å—å, –≤–∞–ª—é—Ç–∞ –∏–ª–∏ order_id)

---

## üìã **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏**

- [ ] `/api/debug/fk` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `fkEnabled: true`
- [ ] –ù–∞ `/ru/pricing` –≤–∏–¥–Ω—ã –∫–Ω–æ–ø–∫–∏ FreeKassa
- [ ] –ö–ª–∏–∫ –≤–µ–¥—ë—Ç –Ω–∞ `pay.freekassa.net` **–±–µ–∑ –æ—à–∏–±–∫–∏**
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –±—Ä–µ–Ω–¥–∏–Ω–≥ "GetLifeUndo" (–Ω–µ "LifeUndo")
- [ ] ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ `FREEKASSA_*` (–±–µ–∑ `FK_*`)

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üéâ
