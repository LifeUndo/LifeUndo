{
  "firewall_rules": [
    {
      "name": "Block Admin Access",
      "expression": "(http.request.uri.path starts_with \"/admin\" or http.request.uri.path starts_with \"/drizzle\") and not ip.src in {ADMIN_IPS}",
      "action": "block",
      "description": "Block admin access except whitelisted IPs"
    }
  ],
  "rate_limit_rules": [
    {
      "name": "API Rate Limit",
      "expression": "http.request.uri.path starts_with \"/api/\"",
      "action": "rate_limit",
      "rate_limit": {
        "requests_per_period": 120,
        "period": 60,
        "burst": 240,
        "ban_duration": 300
      },
      "description": "Rate limit API endpoints: 120 rps, burst 240, ban 5min"
    }
  ],
  "page_rules": [
    {
      "url": "*/drizzle*",
      "settings": {
        "security_level": "essentially_off",
        "cache_level": "bypass"
      }
    }
  ],
  "settings": {
    "always_use_https": true,
    "hsts_enabled": true,
    "hsts_include_subdomains": true,
    "hsts_max_age": 31536000,
    "security_level": "medium",
    "challenge_passage": 1800
  }
}



